### Описание проекта

В данном проекте создается сервис для предсказания заболевания человека на основе датасета ССЫЛКА


### Подготовка к запуску проекта

1. Клонировать проект с github

**git clone url https://github.com/AI-in-IT/IIS**

2. Создать виртуальное окружение 

**python3 -m venv .venv_IIS_1**

**source .venv_IIS_1/bin/activate**

3. Установить все необходимые библиотеки в виртуальную среду:

**pip install -r requirements.txt**


### Запуск MLFlow
Скрипт для запуска MLFlow находится в папке mlflow в файле start_mlflow.

Чтобы развернуть MLFlow локально нужно: перейтив папку со скриптом и выполнить команду:

1. Перейти в папку mlflow

2. Выполнить команду sh start_mlflow.sh

3. Проверить, что фреймворк успешно запустился открыв в браузере страницу http://localhost:5000/

### EDA

В результате предварительного анализа:

* Изменен тип данных с числового на категориальный для 9 столбцов (sex, cp, fbs, restecg, exang, slope, ca, thal, target)
* Изменен тип данных с int64 на int8/int16 для 4 столбцов (age, trestbps, chol, thalach)
* Изменен тип данных с float164 float16 для 1 столбца (oldpeak)
* Удален признак 'chol' вследствие неинформативности.

При построении графиков были выделены следующие закономерности:

1. Из графика распределения целевой переменной (наличия заболевания) - кол-во наблюдений в каждой группе примерно одинаково, что не повлияет на качество обучения модели в будущем. (см. график: ./eda/graph1.png)
2. Из графика распределение пола в зависимости от наличия заболевания - заболевания у мужчин встречаются чаще чем у женщин. (см. график: ./eda/graph2.png)
3. Из графика корреляций признаков - наблдается обратная зависимоть между возрастом и максимальным кол-вом сердченых скоращений, примерно такая же зависимоть наблюдается между частотой сердечных скоращний и ST-маркером. Корреляция остальных признаков слабая. (см. график: ./eda/graph3.png)
4. Из графика зависимости уровня холестерина от возраста - уровень холестерина достаточно неинформативный признак для определения целевой переменной и линейная зависимость ненаблюдается. (см. график: ./eda/graph4.png)
5. Из графика заисимости максимальной частоты сердечного ритма от возраста - достаточно хорошо прослеживается обратная заисимость между возрастом и максимальным середчным ритмом, при этом можно отметить, что наблюдения с более высоким сердречным ритмом чаще поджвержены заболеваниям. (см. график: ./eda/graph5.png)
6. Из графика зависимотси наличия заболевания от типа боли в груди - типы болей 2, 3 и 4 намного чаще соответствуют наличию заболевания, в отличие от типа болей 1. (см. график: ./eda/graph6.png)
7. Из гистограммы распределения возраста с маркеровкой наличия заболевания - группа людей возрастом от 34 до 55 лет наиболее подвержена заболеваниям. (см. график: ./eda/graph7.png)


**Исходный датасет: 11.3 KB —> Обработанный датасет: 7.9 KB**

### Результаты исследования

В ходе исследования было построено несколько моделей. Все модели показали достаточно хорошие результаты, однако лучшие результаты были получены у модели с расширенным кол-вом признаков (предобработка столбцов с помощью PolynomialFeatures) и оптимальными параметрами, которые были получены с помощью библиотеки optuna.

#### Метрики полученные при обучении модели следующие:
accuracy - 0.9285714285714286
precision - 0.9285714285714286
recall - 0.9285714285714286
f1 - 0.9285714285714286
roc_auc - 0.9770408163265306

#### Данные метрики получены при следующих параметрах модели:
n_estimators = 51
max_depth = 20
max_features = 0.8598853604010984

#### RunID финальной модели: ef398bd7999048098a97d90850652408